/*! site 30-07-2014 */
function trim(a){return a.replace(/^\s+|\s+$/g,"")}function userMenu(){var a=$("body").attr("index"),b=Number(a);$("#header").find(".nav li").eq(b-1).addClass("active"),$("#user").hover(function(){console.log("dd"),$("#userMenu").show()},function(){console.log("bb"),$("#userMenu").hide()}),doModify()}function doModify(){onblurEvent(),$("#confirm_new_btn").on("click",function(){var a=$("#oldPwd"),b=$("#newPwd"),c=$("#confirmPwd"),d=$("#old_pwd_err"),e=$("#new_pwd_err"),f=$("#confirm_pwd_err"),g=a.val(),h=b.val(),i=c.val(),j=!1;""==g?(d.text("请输入您现在的密码").parents(".form-group").addClass("has-error"),a.focus()):/^\w{6,20}$/.test(h)?/^\w{6,20}$/.test(i)?i!=h?(f.text(" 您两次输入的密码不一致，请重新输入").parents(".form-group").addClass("has-error"),c.focus()):(f.text("").parents(".form-group").removeClass("has-error"),j=!0):(f.text("格式错误，请重新输入").parents(".form-group").addClass("has-error"),c.focus()):(e.text("格式错误，请重新输入").parents(".form-group").addClass("has-error"),b.focus());var k=pwdValidate();return j&&k?void formSubmit():!1}),$("#modify_pwd_close").on("click",function(){$(".form-horizontal")[0].reset(),$("#old_pwd_err").text("").parents(".form-group").removeClass("has-error"),$("#new_pwd_err").text("").parents(".form-group").removeClass("has-error"),$("#confirm_pwd_err").text("").parents(".form-group").removeClass("has-error"),$("#modify_msg").text("")}),$("#cancel_btn").on("click",function(){$(".form-horizontal")[0].reset(),$("#old_pwd_err").text("").parents(".form-group").removeClass("has-error"),$("#new_pwd_err").text("").parents(".form-group").removeClass("has-error"),$("#confirm_pwd_err").text("").parents(".form-group").removeClass("has-error"),$("#modify_msg").text("")})}function onblurEvent(){$("#oldPwd").blur(function(){pwdValidate()}),$("#newPwd").blur(function(){var a=$("#newPwd").val();""==a?$("#new_pwd_err").text("请输入新密码").parents(".form-group").addClass("has-error"):/^\w{6,20}$/.test(a)?$("#new_pwd_err").text("").parents(".form-group").removeClass("has-error"):$("#new_pwd_err").text("格式错误，请重新输入").parents(".form-group").addClass("has-error")})}function pwdValidate(){var a=$("#oldPwd").val(),b=!1;return $.ajax({url:"/doValidate",type:"post",dataType:"json",async:!1,data:{oldPwd:$.md5(a)},success:function(c){c.success?($("#old_pwd_err").text("").parents(".form-group").removeClass("has-error"),b=!0):(""==a?$("#old_pwd_err").text("请输入您现在的密码").parents(".form-group").addClass("has-error"):$("#old_pwd_err").text(c.message).parents(".form-group").addClass("has-error"),b=!1)}}),b}function formSubmit(){var a=$("#oldPwd").val();if(""!=newPwd&&""!=confirmPwd){var b=$.md5($("#newPwd").val()),c=$.md5($("#confirmPwd").val());$.ajax({url:"/doModify",type:"post",dataType:"json",data:{oldPwd:a,newPwd:b,confirmPwd:c},success:function(a){a.success?($("#modify_msg").text(a.message),setTimeout(function(){window.location="/logout"},1500)):$("#modify_msg").text(a.message)}})}}function get(){for(var a=new Array,b=0;b<arguments.length;b++){var c=arguments[b];if("string"==typeof c&&(c=document.getElementById(c)),1==arguments.length)return c;a.push(c)}return a}function checkAllEvent(){$(document).on("ifToggled","#allcheck",function(a){var b=a.target.checked;checkAll(b)})}function checkAll(a){for(var b=get("table_list").getElementsByTagName("input"),c=1;c<b.length;c++){var d=b[c];"checkbox"===d.type&&(a?($(d).iCheck("check"),$(d).parents("tr").addClass("warning")):($(d).iCheck("uncheck"),$(d).parents("tr").removeClass("warning")))}}function inputChecked(a){for(var b=get(a).getElementsByTagName("input"),c=[],d=0;d<b.length;d++){var e=b[d];$(e).parent().hasClass("checked")&&e.getAttribute("data-id")&&c.push(e)}return c}function tooltip(a,b){$(a).tooltip("destroy"),$(a).tooltip({title:b,placement:"bottom",trigger:"focus"}),$(a).tooltip("show")}function infoUpload(a){var b=a.fileInput;b.fileupload({dataType:"json",add:function(b,c){c.context=a.context,c.submit()},done:function(b,c){var d=c.result.file_path;c.context.find("img").attr("src",d).show(),c.context.find("i").hide(),a.hiddenInput.val(c.result.fileName)},progressall:function(b,c){var d=parseInt(c.loaded/c.total*100,10);$("#"+a.progress+" .progress-bar").css("width",d+"%")},start:function(){$("#"+a.progress).removeClass("hide"),"undefined"!=typeof a.uploaddone&&a.uploaddone()},stop:function(){setTimeout(function(){$("#"+a.progress).addClass("hide")},1e3)}})}var paginator=function(a){var b={currentPage:1,totalPages:10,numberOfPages:5,size:"normal",alignment:"center",useBootstrapTooltip:!0,bootstrapMajorVersion:3,tooltipTitles:function(a,b){switch(a){case"first":return"首页";case"prev":return"上一页";case"next":return"下一页";case"last":return"尾页";case"page":return"第"+b+"页"}},bootstrapTooltipOptions:{html:!0,placement:"bottom"},itemContainerClass:function(a,b,c){return b===c?"active":"pointer-cursor"},onPageChanged:function(a,b,c){print("Current page changed, old: "+b+" new: "+c)}};return a.paging=function(a){b=$.extend(b,a);var c;c=$(b.id?b.id:"#pagebar"),c.bootstrapPaginator(b)},a}({}),DataCache=function(){this.size=0,this.caches={}};DataCache.prototype={remove:function(a){delete this.caches[a]},get:function(a){return this.caches[a]},set:function(a,b){this.caches[a]=b,this.size+=1},clear:function(){this.caches={}}};